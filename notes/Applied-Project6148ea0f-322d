{"type":"doc","content":[{"type":"heading","attrs":{"textAlign":"left","id":"heading-1","level":3},"content":[{"type":"text","text":"Comprehensive Notes on Kalman Filtering Implementation for Core Temperature Estimation"}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-2","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Objective"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The primary objective was to estimate core body temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"CoreTemp_Estimate"},{"type":"text","text":") using observed data from heart rate ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":") and skin temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":") through "},{"type":"text","marks":[{"type":"bold"}],"text":"Kalman Filtering"},{"type":"text","text":". The core temperature ground truth ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":") was used for evaluation. The methodology accounts for noise in both measurements and state transitions while dynamically fusing the two input signals."}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-3","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Dataset"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Data"},{"type":"text","text":": Multi-participant dataset containing timestamps, heart rate, skin temperature (from the hand), and core temperature."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Sampling Rate"},{"type":"text","text":": The data was recorded at a uniform interval of "},{"type":"text","marks":[{"type":"bold"}],"text":"1 minute per observation"},{"type":"text","text":" (validated during preprocessing)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"States Used"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"State Variable ("},{"type":"text","marks":[{"type":"code"}],"text":"X"},{"type":"text","text":"): Core temperature (scalar value)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observations ("},{"type":"text","marks":[{"type":"code"}],"text":"Y"},{"type":"text","text":"): A vector consisting of:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":": Heart rate."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":": Skin temperature measured from the hand."}]}]}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-4","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Kalman Filter Design"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"State Transition ("},{"type":"text","marks":[{"type":"code"}],"text":"F"},{"type":"text","text":"):"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Defined as an identity matrix ("},{"type":"text","marks":[{"type":"code"}],"text":"F = I"},{"type":"text","text":"), assuming no complex dynamics between consecutive core temperature states."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observation Model ("},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":"):"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Initially, weights were manually set equally ("},{"type":"text","marks":[{"type":"code"}],"text":"H = [0.5, 0.5]"},{"type":"text","text":") to balance the contribution of heart rate and skin temperature."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Later, "},{"type":"text","marks":[{"type":"bold"}],"text":"Linear Regression"},{"type":"text","text":" was applied to calculate "},{"type":"text","marks":[{"type":"bold"}],"text":"dynamic weights"},{"type":"text","text":" based on the correlation between observations ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":") and the ground truth ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":"):"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":" was updated to represent relative importance derived from model coefficients."}]}]}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Process Noise Covariance ("},{"type":"text","marks":[{"type":"code"}],"text":"Q"},{"type":"text","text":"):"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Accounts for uncertainty in state transitions."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Initialized as a fraction of the variance of "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":"."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Measurement Noise Covariance ("},{"type":"text","marks":[{"type":"code"}],"text":"R"},{"type":"text","text":"):"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Encodes the uncertainty in sensor measurements."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Derived dynamically from the variance of "},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":"."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Normalization"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Observations ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":", and "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":") were "},{"type":"text","marks":[{"type":"bold"}],"text":"z-score normalized"},{"type":"text","text":" before applying Kalman filtering to ensure numerical stability."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Prediction and Update Steps"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Prediction"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"X_pred = F @ X"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"P_pred = F @ P @ F.T + Q"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Update"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Calculate innovation covariance: "},{"type":"text","marks":[{"type":"code"}],"text":"S = H @ P_pred @ H.T + R"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute Kalman Gain: "},{"type":"text","marks":[{"type":"code"}],"text":"K = P_pred @ H.T @ np.linalg.inv(S)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update state estimate: "},{"type":"text","marks":[{"type":"code"}],"text":"X = X_pred + K @ (Y - H @ X_pred)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P = (I - K @ H) @ P_pred"}]}]}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"De-normalization"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Kalman filter output was de-normalized back to the original scale of "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":" using its mean and standard deviation for interpretability."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-5","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Key Changes and Improvements"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Initial Attempt"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Simple weights ("},{"type":"text","marks":[{"type":"code"}],"text":"H = [0.5, 0.5]"},{"type":"text","text":") led to "},{"type":"text","marks":[{"type":"bold"}],"text":"inconsistent results"},{"type":"text","text":" due to a lack of consideration for varying contributions of "},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":" across participants and conditions."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Dynamic Observation Weights"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Implementing "},{"type":"text","marks":[{"type":"bold"}],"text":"Linear Regression"},{"type":"text","text":" to derive weights ("},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":") improved accuracy by adapting the filter to the dataset's specific characteristics."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Error Handling"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Kalman filtering was prone to errors when the observation covariance matrix ("},{"type":"text","marks":[{"type":"code"}],"text":"R"},{"type":"text","text":") or innovation covariance matrix ("},{"type":"text","marks":[{"type":"code"}],"text":"S"},{"type":"text","text":") became singular. These cases were identified and skipped dynamically."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Metrics and Evaluation"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"For each "},{"type":"text","marks":[{"type":"bold"}],"text":"Participant-Condition-Activity"},{"type":"text","text":" combination, the following metrics were calculated:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Mean Absolute Error (MAE)"},{"type":"text","text":": Average magnitude of the prediction error."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Root Mean Squared Error (RMSE)"},{"type":"text","text":": Penalty on larger prediction errors."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Mean Absolute Percentage Error (MAPE)"},{"type":"text","text":": Error as a percentage of the true value."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"R² Score"},{"type":"text","text":": Explained variance; higher values indicate better performance."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Observed "},{"type":"text","marks":[{"type":"bold"}],"text":"R² Scores"},{"type":"text","text":" ranged from -0.21 (poor fit) to 0.84 (strong fit), varying across combinations."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Normalization"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Ensured stability by converting all features to zero-mean, unit-variance before Kalman filtering."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-6","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Summary of Results"}]},{"type":"bulletList","attrs":{"tight":false},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Top Combinations"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The Kalman filter was applied to "},{"type":"text","marks":[{"type":"bold"}],"text":"10 Participant-Condition-Activity combinations"},{"type":"text","text":" with the highest number of data points."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Output was saved as a consolidated CSV file ("},{"type":"text","marks":[{"type":"code"}],"text":"Kalman_Filter_Results.csv"},{"type":"text","text":") containing all estimates."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Performance"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Ranges for the top combinations:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"MAE: 0.19 - 0.39 °C"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"RMSE: 0.23 - 0.43 °C"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"MAPE: 0.5% - 1.04%"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"R² Score: -0.21 to 0.84"}]}]}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Best Combination"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Participant 6, Condition 2, Activity 5 showed the lowest error metrics:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"MAE: 0.2485 °C"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"RMSE: 0.2800 °C"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"R² Score: 0.8432"}]}]}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-7","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Challenges and Considerations"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Missing Data"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Combinations with missing values were skipped to maintain model integrity."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Singular Matrix Errors"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Identified and skipped combinations where covariance matrices caused singularities."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Global Application"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Kalman filtering was applied independently to each combination to account for participant-specific dynamics."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-8","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Next Steps"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Extended Kalman Filter (EKF)"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Introduce non-linear relationships between variables for improved estimation."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Machine Learning Models"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Train models such as Random Forest or Gradient Boosting on the entire dataset to compare performance against Kalman filtering."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Time-Windowed Kalman Filtering"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Explore sliding windows of "},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":" observations for smoother state estimation."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This provides a detailed technical breakdown of the Kalman filtering methodology, decisions, and results, making it ready for inclusion in a presentation or technical document."}]},{"type":"paragraph","attrs":{"textAlign":"left"}},{"type":"paragraph","attrs":{"textAlign":"left"}},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"By applying "},{"type":"text","marks":[{"type":"bold"}],"text":"Linear Regression"},{"type":"text","text":" to calculate the observation weights ("},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":"), we found the relative contribution of "},{"type":"text","marks":[{"type":"bold"}],"text":"Heart Rate (HR)"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"bold"}],"text":"Skin Temperature (SkinTemp hand)"},{"type":"text","text":" to the estimation of core temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":")."}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-9","level":3},"content":[{"type":"text","text":"Key Findings:"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Higher Weights"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"SkinTemp hand"},{"type":"text","text":" consistently had a "},{"type":"text","marks":[{"type":"bold"}],"text":"higher weight"},{"type":"text","text":" compared to "},{"type":"text","marks":[{"type":"bold"}],"text":"HR"},{"type":"text","text":" in most combinations."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This indicates that "},{"type":"text","marks":[{"type":"bold"}],"text":"skin temperature"},{"type":"text","text":" is a stronger predictor of core temperature compared to heart rate in this dataset."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Interpretation"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Higher weights for "},{"type":"text","marks":[{"type":"bold"}],"text":"SkinTemp hand"},{"type":"text","text":" align with physiological understanding:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Skin temperature directly reflects thermal conditions near the body, which strongly correlates with core temperature in controlled environments."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"HR"},{"type":"text","text":", while correlated with core temperature, may be influenced by other factors like physical activity intensity, stress, or hydration, making it less predictive in isolation."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Dynamic Adjustment"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"By using regression-derived weights, we adapted the Kalman filter to prioritize "},{"type":"text","marks":[{"type":"bold"}],"text":"SkinTemp hand"},{"type":"text","text":" over "},{"type":"text","marks":[{"type":"bold"}],"text":"HR"},{"type":"text","text":" in the estimation process. This improved accuracy, as the filter now reflected the dataset's true dynamics."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"These findings emphasize the value of using "},{"type":"text","marks":[{"type":"bold"}],"text":"data-driven observation weights"},{"type":"text","text":" to improve Kalman filter performance, especially when the predictive power of input variables varies significantly."}]},{"type":"paragraph","attrs":{"textAlign":"left"}},{"type":"heading","attrs":{"textAlign":"left","id":"heading-10","level":3},"content":[{"type":"text","text":"Extended Kalman Filter (EKF) for Core Temperature Estimation"}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-11","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Introduction to EKF"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"Extended Kalman Filter (EKF)"},{"type":"text","text":" is an extension of the Kalman Filter designed for systems with "},{"type":"text","marks":[{"type":"bold"}],"text":"nonlinear process"},{"type":"text","text":" or "},{"type":"text","marks":[{"type":"bold"}],"text":"observation models"},{"type":"text","text":". It linearizes these nonlinearities around the current state estimate using the "},{"type":"text","marks":[{"type":"bold"}],"text":"first-order Taylor series expansion"},{"type":"text","text":"."}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-12","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Steps in EKF"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Prediction Step"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict the next state: "},{"type":"text","marks":[{"type":"code"}],"text":"X_pred = process_model(X)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict the covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P_pred = F @ P @ F.T + Q"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Update Step"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute innovation covariance: "},{"type":"text","marks":[{"type":"code"}],"text":"S = H @ P_pred @ H.T + R"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute Kalman Gain: "},{"type":"text","marks":[{"type":"code"}],"text":"K = P_pred @ H.T @ np.linalg.inv(S)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update state estimate: "},{"type":"text","marks":[{"type":"code"}],"text":"X = X_pred + K @ (Y - H @ X_pred)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P = (np.eye(len(P)) - K @ H) @ P_pred"}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-13","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Nonlinear Models"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Process Model"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Assumes a simple linear evolution of the core temperature (no dynamics): "},{"type":"text","marks":[{"type":"code"}],"text":"def process_model(T_c): return T_c"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observation Model"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Based on physiological research:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Heart Rate (HR): "},{"type":"text","marks":[{"type":"code"}],"text":"HR = a * np.exp(b * T_c) + c"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Skin Temperature: "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp = d * T_c + g"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Combined: "},{"type":"text","marks":[{"type":"code"}],"text":"observation_model = np.array([HR, SkinTemp])"}]}]}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Jacobian of the Observation Model"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Partial derivatives for linearizing the observation model:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"dHR_dTc = a * b * np.exp(b * T_c)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"dSkinTemp_dTc = d"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Jacobian: "},{"type":"text","marks":[{"type":"code"}],"text":"jacobian = np.array([[dHR_dTc], [dSkinTemp_dTc]])"}]}]}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-14","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Implementation Workflow"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Initialize Parameters"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"State vector (core temperature): "},{"type":"text","marks":[{"type":"code"}],"text":"X = np.array([[36.5]])"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P = np.eye(1)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Transition matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"F = np.eye(1)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Process noise covariance: "},{"type":"text","marks":[{"type":"code"}],"text":"Q = np.array([[1e-4]])"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Measurement noise covariance: "},{"type":"text","marks":[{"type":"code"}],"text":"R = np.diag([np.var(HR) * 0.1, np.var(SkinTemp) * 0.1])"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Iterative Process"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"For each time step:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict the next state: "},{"type":"text","marks":[{"type":"code"}],"text":"X_pred = process_model(X)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict the covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P_pred = F @ P @ F.T + Q"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Calculate the Jacobian: "},{"type":"text","marks":[{"type":"code"}],"text":"H = jacobian(X_pred, a, b, d)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict observations using the observation model: "},{"type":"text","marks":[{"type":"code"}],"text":"Y_pred = observation_model(X_pred, a, b, c, d, g)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute innovation covariance: "},{"type":"text","marks":[{"type":"code"}],"text":"S = H @ P_pred @ H.T + R"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute Kalman Gain: "},{"type":"text","marks":[{"type":"code"}],"text":"K = P_pred @ H.T @ np.linalg.inv(S)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update state estimate: "},{"type":"text","marks":[{"type":"code"}],"text":"X = X_pred + K @ (Y - Y_pred)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update covariance matrix: "},{"type":"text","marks":[{"type":"code"}],"text":"P = (np.eye(len(P)) - K @ H) @ P_pred"}]}]}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-15","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"EKF Adjustments for Core Temperature Estimation"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The nonlinear observation model captures the "},{"type":"text","marks":[{"type":"bold"}],"text":"exponential dependence of heart rate"},{"type":"text","text":" on core temperature and the "},{"type":"text","marks":[{"type":"bold"}],"text":"linear relationship of skin temperature"},{"type":"text","text":" with core temperature."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"We used parameters"}]},{"type":"mathBlock","attrs":{"text":""}},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":" derived from prior domain knowledge to model realistic physiological interactions."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Normalization and de-normalization"},{"type":"text","text":" were applied to ensure numerical stability."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-16","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Challenges"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"Jacobian approximation"},{"type":"text","text":" introduces errors if the nonlinearities are severe."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"A "},{"type":"text","marks":[{"type":"bold"}],"text":"poor initial estimate"},{"type":"text","text":" for state or covariance can diverge the filter."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The EKF "},{"type":"text","marks":[{"type":"bold"}],"text":"did not perform better than KF"},{"type":"text","text":" in our case, possibly due to oversimplified assumptions in the observation model."}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-17","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Results and Observations"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"Extended Kalman Filter (EKF)"},{"type":"text","text":" was applied to capture nonlinear trends, particularly leveraging physiological relationships. Despite its ability to model nonlinear dynamics, the "},{"type":"text","marks":[{"type":"bold"}],"text":"performance metrics for EKF were unexpectedly poorer than those for the standard Kalman Filter"},{"type":"text","text":" in our scenario:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Mean Absolute Error (MAE):"},{"type":"text","text":" 0.4416"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Root Mean Squared Error (RMSE):"},{"type":"text","text":" 0.5007"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Mean Absolute Percentage Error (MAPE):"},{"type":"text","text":" 1.17%"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"R² Score:"},{"type":"text","text":" −0.063"}]}]}]},{"type":"paragraph","attrs":{"textAlign":"left"}},{"type":"heading","attrs":{"textAlign":"left","id":"heading-18","level":2},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Windowed Kalman Filter Notes"}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-19","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Concept"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"Windowed Kalman Filter (WKF)"},{"type":"text","text":" extends the standard Kalman Filter by considering a "},{"type":"text","marks":[{"type":"bold"}],"text":"sliding window of multiple observations"},{"type":"text","text":" for each update."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Instead of updating the state using only the most recent observation, the filter aggregates information from a fixed number of past observations (e.g., 5)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This approach improves robustness to noise and captures trends over short timeframes."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-20","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Key Components"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Sliding Window"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"A window of size "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" (e.g., 5 observations) is used."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Observations from the last "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" timestamps ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":") are stacked to create a larger observation vector "},{"type":"text","marks":[{"type":"code"}],"text":"Y_window"},{"type":"text","text":"."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"State Vector"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The state vector remains the same: "},{"type":"text","marks":[{"type":"code"}],"text":"X"},{"type":"text","text":" represents the core temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":")."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observation Model"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The observation matrix "},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":" is replicated "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" times to form a larger matrix "},{"type":"text","marks":[{"type":"code"}],"text":"H_windowed"},{"type":"text","text":"."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This allows all "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" observations to influence the state estimate simultaneously."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Benefits"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Aggregates information from multiple observations, reducing the impact of outliers."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Captures short-term trends more effectively."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Drawbacks"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Increased computational complexity due to larger matrices."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Potential loss of real-time responsiveness if the window size is too large."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-21","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Mathematical Framework"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"For a sliding window of size "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":":"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"State Prediction"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"X_pred = F @ X"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"P_pred = F @ P @ F.T + Q"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observation Vector"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"Y_window = [Y_t, Y_t-1, ..., Y_t-N+1]"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Windowed Observation Matrix"},{"type":"text","text":":"}]},{"type":"codeBlock","attrs":{"language":null,"collapsed":false},"content":[{"type":"text","text":"makefile"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Copy code"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"H_windowed = [ H H ... H ] # Shape: (N * obs_dim) x state_dim"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Update Step"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Calculate the "},{"type":"text","marks":[{"type":"bold"}],"text":"Innovation Covariance"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"S = H_windowed @ P_pred @ H_windowed.T + R"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Compute the "},{"type":"text","marks":[{"type":"bold"}],"text":"Kalman Gain"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"K = P_pred @ H_windowed.T @ np.linalg.inv(S)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update the "},{"type":"text","marks":[{"type":"bold"}],"text":"State Estimate"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"X = X_pred + K @ (Y_window - H_windowed @ X_pred)"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update the "},{"type":"text","marks":[{"type":"bold"}],"text":"Covariance Matrix"},{"type":"text","text":": "},{"type":"text","marks":[{"type":"code"}],"text":"P = (I - K @ H_windowed) @ P_pred"}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-22","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Implementation Details"}]},{"type":"bulletList","attrs":{"tight":false},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Sliding Window Size"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"A fixed window size of 5 observations was chosen, representing approximately 5 minutes of data."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Observations include "},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":"."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Observation Model"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":" contribute to the observation matrix "},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":", whose weights are derived using a regression model."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Each observation in the window contributes equally."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Normalization"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Input features ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":") and ground truth ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":") are normalized before processing to ensure numerical stability."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"De-normalization"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The estimated core temperature is de-normalized to match the original scale for comparison."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-23","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Example Windowed Workflow"}]},{"type":"orderedList","attrs":{"tight":false,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"For each timestamp:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Collect the last "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" observations ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":", and "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Stack these into "},{"type":"text","marks":[{"type":"code"}],"text":"Y_window"},{"type":"text","text":"."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Predict the state using the transition model."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Update the state using the aggregated windowed observations and the expanded observation matrix."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-24","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Results and Observations"}]},{"type":"bulletList","attrs":{"tight":false},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Performance Metrics"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The WKF typically provides smoother estimates compared to the standard Kalman Filter."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"It effectively handles noisy data by incorporating recent trends into the state estimation."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Trend Matching"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Despite the benefits of smoother estimates, if the window size is too large, the WKF may fail to capture sudden transitions or dynamic trends."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Limitations"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Increased computational complexity due to larger observation vectors and matrices."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Potential for numerical instability if the observation noise covariance matrix "},{"type":"text","marks":[{"type":"code"}],"text":"R"},{"type":"text","text":" is not well-tuned."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This is an excellent and fundamental question, so let’s break it down carefully:"}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-25","level":3},"content":[{"type":"text","text":"1. "},{"type":"text","marks":[{"type":"bold"}],"text":"How is a single observation used?"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"In the "},{"type":"text","marks":[{"type":"bold"}],"text":"standard Kalman Filter"},{"type":"text","text":", for every timestamp, we use "},{"type":"text","marks":[{"type":"bold"}],"text":"one observation"},{"type":"text","text":" of the measurements ("},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":") to update the estimate of the core temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The Kalman Filter combines:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"prediction"},{"type":"text","text":" based on the prior state (from the system dynamics)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"new observation"},{"type":"text","text":" (single data point for "},{"type":"text","marks":[{"type":"code"}],"text":"HR"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"SkinTemp hand"},{"type":"text","text":")."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This single observation provides a "},{"type":"text","marks":[{"type":"bold"}],"text":"correction"},{"type":"text","text":" to the predicted state."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-26","level":3},"content":[{"type":"text","text":"2. "},{"type":"text","marks":[{"type":"bold"}],"text":"How does the Kalman Filter capture trends?"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"state estimate"},{"type":"text","text":" is updated iteratively, meaning the filter "},{"type":"text","marks":[{"type":"bold"}],"text":"carries forward information from previous timestamps"},{"type":"text","text":"."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Even though only one new observation is used at each step, the Kalman Filter inherently builds a "},{"type":"text","marks":[{"type":"bold"}],"text":"state history"},{"type":"text","text":" via:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"state transition matrix ("},{"type":"text","marks":[{"type":"code"}],"text":"F"},{"type":"text","text":"): This models how the core temperature evolves over time (e.g., it might stay stable or gradually change depending on system dynamics)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"covariance matrix ("},{"type":"text","marks":[{"type":"code"}],"text":"P"},{"type":"text","text":"): This tracks the uncertainty in the state and observation."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"Kalman Gain ("},{"type":"text","marks":[{"type":"code"}],"text":"K"},{"type":"text","text":"): This controls how much weight is given to the new observation versus the prediction."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"In essence, the Kalman Filter doesn't "},{"type":"text","marks":[{"type":"bold"}],"text":"throw away the past"},{"type":"text","text":". Instead, it uses the "},{"type":"text","marks":[{"type":"bold"}],"text":"prior state"},{"type":"text","text":" and its uncertainty as a foundation, while the new observation refines it."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-27","level":3},"content":[{"type":"text","text":"3. "},{"type":"text","marks":[{"type":"bold"}],"text":"Why does this work so well?"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Predict-Update Cycle"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"prediction step"},{"type":"text","text":" projects the core temperature forward based on the previous state and dynamics."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"update step"},{"type":"text","text":" corrects the predicted state using the new observation."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The trend comes from the "},{"type":"text","marks":[{"type":"bold"}],"text":"combination of prior states and new observations"},{"type":"text","text":". Even if the current observation has noise, the filter weights it against the prediction based on the previous states."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"This iterative refinement allows the Kalman Filter to smooth noisy data and capture trends, even when using only one observation at a time."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-28","level":3},"content":[{"type":"text","text":"4. "},{"type":"text","marks":[{"type":"bold"}],"text":"Why isn’t this just \"fitting the data\"?"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The Kalman Filter isn’t just interpolating or fitting the data—it’s "},{"type":"text","marks":[{"type":"bold"}],"text":"estimating the true state of the system"},{"type":"text","text":" by:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Incorporating the measurement model ("},{"type":"text","marks":[{"type":"code"}],"text":"H"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Accounting for process and measurement noise ("},{"type":"text","marks":[{"type":"code"}],"text":"Q"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"code"}],"text":"R"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Dynamically adjusting the state estimate based on new information."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The "},{"type":"text","marks":[{"type":"bold"}],"text":"mathematics of uncertainty propagation"},{"type":"text","text":" ensures that it doesn’t overfit or trust any single observation too much."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-29","level":3},"content":[{"type":"text","text":"5. "},{"type":"text","marks":[{"type":"bold"}],"text":"How does this compare to a windowed approach?"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"In the standard Kalman Filter, the state evolves continuously, and each update is "},{"type":"text","marks":[{"type":"bold"}],"text":"localized"},{"type":"text","text":" to the most recent observation."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"In the windowed approach, the filter explicitly considers multiple recent observations together, which can improve robustness but increases computational complexity."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-30","level":3},"content":[{"type":"text","text":"6. "},{"type":"text","marks":[{"type":"bold"}],"text":"Key Insights"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Even though we’re using a single observation at each step, the Kalman Filter relies on the "},{"type":"text","marks":[{"type":"bold"}],"text":"cumulative history"},{"type":"text","text":" encoded in the state estimate and its covariance."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The accuracy comes from the interplay between "},{"type":"text","marks":[{"type":"bold"}],"text":"predictions"},{"type":"text","text":" (based on system dynamics) and "},{"type":"text","marks":[{"type":"bold"}],"text":"observations"},{"type":"text","text":" (providing updates)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The filter assumes that noise in the observations is random, so over time, the state estimate converges toward the true trend."}]}]}]},{"type":"horizontalRule"},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"If this still feels counterintuitive, we can try visualizing the "},{"type":"text","marks":[{"type":"bold"}],"text":"predicted state"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"bold"}],"text":"updated state"},{"type":"text","text":" at each step to see how the trend emerges. Let me know if you'd like to explore this further!"}]},{"type":"paragraph","attrs":{"textAlign":"left"}},{"type":"heading","attrs":{"textAlign":"left","id":"heading-31","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Notes: XGBoost and LSTM Models for Core Temperature Prediction"}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-32","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Objective"}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"To predict core temperature ("},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":") using:"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"XGBoost"},{"type":"text","text":": A gradient-boosted decision tree model for regression."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"LSTM (Long Short-Term Memory)"},{"type":"text","text":": A recurrent neural network model for time-series data."}]}]}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The primary features used were "},{"type":"text","marks":[{"type":"bold"}],"text":"heart rate (HR)"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"bold"}],"text":"hand skin temperature"},{"type":"text","text":", reflecting a realistic scenario where only limited physiological data is available."}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-33","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"1. XGBoost Model"}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-34","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Setup"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Features used:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"HR"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"SkinTemp hand"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Target: "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":" (core temperature)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Dataset:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Training: 80% of the dataset (excluding "},{"type":"text","marks":[{"type":"code"}],"text":"Participant=8, Condition=2, Activity Code=5"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Testing: 20% of the dataset (excluding the same participant-condition combination)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Prediction: Data for "},{"type":"text","marks":[{"type":"code"}],"text":"Participant=8, Condition=2, Activity Code=5"},{"type":"text","text":"."}]}]}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-35","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Results"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAE"},{"type":"text","text":": 0.15"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"RMSE"},{"type":"text","text":": 0.20"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAPE"},{"type":"text","text":": 0.40%"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"R²"},{"type":"text","text":": 0.88"}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-36","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Key Observations"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"XGBoost performed exceptionally well with low errors and high R²."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The model successfully generalized to unseen data for testing, with consistent accuracy."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The high R² (88%) indicates that the model explains most of the variance in core temperature."}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-37","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Strengths of XGBoost"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Handles non-linear relationships and missing values well."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Efficient in training with a strong ensemble-based predictive capability."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-38","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"2. LSTM Model"}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-39","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Setup"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Features used:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"HR"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"SkinTemp hand"}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Target: "},{"type":"text","marks":[{"type":"code"}],"text":"Corerectal"},{"type":"text","text":"."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Sequence length (lookback window): 10 time steps."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Dataset:"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Training: 80% of the dataset (excluding "},{"type":"text","marks":[{"type":"code"}],"text":"Participant=8, Condition=2, Activity Code=5"},{"type":"text","text":")."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Testing: 20% of the dataset (excluding the same participant-condition combination)."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Prediction: Data for "},{"type":"text","marks":[{"type":"code"}],"text":"Participant=8, Condition=2, Activity Code=5"},{"type":"text","text":"."}]}]}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-40","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Results"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAE"},{"type":"text","text":": 0.11"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"RMSE"},{"type":"text","text":": 0.14"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAPE"},{"type":"text","text":": 41.96%"}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"R²"},{"type":"text","text":": 0.26"}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-41","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Key Observations"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"While the MAE and RMSE values are low, the MAPE is significantly high, indicating relative prediction errors for smaller values."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The low R² (26%) suggests the model struggles to explain the variance in core temperature with only these two features."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Temporal dependencies may not be sufficiently strong in the data, limiting the effectiveness of LSTM."}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-42","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Strengths and Weaknesses of LSTM"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Strengths"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Effective for time-series data with long-term dependencies."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Handles sequential patterns well if strong temporal relationships exist."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Weaknesses"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Requires sufficient temporal patterns, which might be limited with just two features."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Computationally more expensive compared to XGBoost."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-43","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Comparison of Models"}]},{"type":"table","content":[{"type":"tableRow","content":[{"type":"tableHeader","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Metric"}]}]},{"type":"tableHeader","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"XGBoost"}]}]},{"type":"tableHeader","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"LSTM"}]}]}]},{"type":"tableRow","content":[{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAE"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.15"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.11"}]}]}]},{"type":"tableRow","content":[{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"RMSE"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.20"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.14"}]}]}]},{"type":"tableRow","content":[{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MAPE"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.40%"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"41.96%"}]}]}]},{"type":"tableRow","content":[{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"R²"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.88"}]}]},{"type":"tableCell","attrs":{"colspan":1,"rowspan":1,"colwidth":null},"content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"0.26"}]}]}]}]},{"type":"heading","attrs":{"textAlign":"left","id":"heading-44","level":4},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Insights"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"XGBoost outperforms LSTM in terms of all key metrics except MAE, which is marginally better for LSTM."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"The high MAPE and low R² for LSTM indicate that HR and hand skin temperature alone are insufficient to model core temperature as a time-series problem."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"XGBoost leverages non-linear relationships between features, which likely contributed to its superior performance."}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-45","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Conclusion"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"XGBoost"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Best-suited for the given dataset and problem setup."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Achieved robust predictions with low error and high variance explanation."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"LSTM"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Struggled with the limited features and weak temporal dependencies in the data."}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"May require additional features or stronger temporal patterns to perform well."}]}]}]}]}]},{"type":"horizontalRule"},{"type":"heading","attrs":{"textAlign":"left","id":"heading-46","level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Future Directions"}]},{"type":"orderedList","attrs":{"tight":true,"start":1},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Feature Engineering"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Incorporate engineered features like elapsed time or environmental conditions."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Hybrid Models"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Combine XGBoost with time-series models for better performance on sequential data."}]}]}]}]},{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Explore Simpler Models"},{"type":"text","text":":"}]},{"type":"bulletList","attrs":{"tight":true},"content":[{"type":"listItem","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"Use ARIMA or SARIMAX for baseline comparison on time-series tasks."}]}]}]}]}]},{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"These notes provide a comprehensive overview of the experiments and their outcomes. Let me know if you'd like to refine any section!"}]}]}